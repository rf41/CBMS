<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Child Behavior Monitoring System</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <div class="notification-toast" id="notificationToast">
        <div class="notification-icon">üîó</div>
        <div class="notification-content">
            <p class="notification-title">Doll is connected to device</p>
            <p class="notification-message">Processing sensor data...</p>
        </div>
    </div>
    
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="assets/TeddyTalk.jpeg" class="logo-img">
                <div class="logo">
                    <span class="logo-text">Child Behavior Monitoring System</span>
                </div>
            </div>
            <ul class="nav-menu" id="navMenu">
                <li><button class="nav-link active" data-section="home">Home</button></li>
                <li><button class="nav-link" data-section="dashboard">Test API</button></li>
                <li><button class="nav-link" data-section="analysis">Analysis</button></li>
                <li><button class="nav-link" data-section="recommendation">Recommendation</button></li>
            </ul>
            <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
        </div>
    </nav>

    <div class="container">
        <!-- HOME SECTION -->
        <section id="home" class="section active">
            <div class="section-header">
                <h1>Teddy Talk</h1>
                <p class="section-subtitle">Child Behavior Monitoring System</p>
            </div>

            <div class="cards-grid">
                <div class="card feature-card">
                    <div class="card-icon"><img src="assets/Chart.jpeg" class="card-img"></div>
                    <h3>Smart Analysis</h3>
                    <p>Advanced sensor data analysis to identify behavioral patterns and risk indicators in real-time.</p>
                </div>

                <div class="card feature-card">
                    <div class="card-icon"><img src="assets/Lock.jpeg" class="card-img"></div>
                    <h3>Privacy First</h3>
                    <p>All data processing happens locally on your device. No data is stored or transmitted to servers.</p>
                </div>

                <div class="card feature-card">
                    <div class="card-icon"><img src="assets/Lightning.jpeg" class="card-img"></div>
                    <h3>Instant Results</h3>
                    <p>Get immediate risk assessment with detailed explanations and actionable recommendations.</p>
                </div>

                <div class="card feature-card">
                    <div class="card-icon"><img src="assets/List.jpeg" class="card-img"></div>
                    <h3>Comprehensive Report</h3>
                    <p>View detailed sensor metrics and personalized recommendations based on the analysis.</p>
                </div>
            </div>

            <div class="card info-card">
                <h2>How It Works</h2>
                <ol class="info-list">
                    <li><strong>Test API:</strong> Save new data and test database operations</li>
                    <li><strong>Analysis:</strong> Our system analyzes latest 10 records from database</li>
                    <li><strong>Risk Assessment:</strong> View trends with charts and statistics</li>
                    <li><strong>Recommendations:</strong> Receive tailored guidance based on data analysis</li>
                </ol>
            </div>

            <div class="card disclaimer-card">
                <div class="disclaimer-icon">‚ö†Ô∏è</div>
                <h2>Important Disclaimer</h2>
                <p><strong>This is an educational prototype and NOT a medical diagnosis tool.</strong> This system analyzes behavioral patterns from sensor data but does NOT diagnose autism or any medical condition. Always consult qualified healthcare professionals for proper medical assessment and diagnosis.</p>
            </div>
        </section>

        <!-- TEST API SECTION -->
        <section id="dashboard" class="section">
            <div class="section-header">
                <h1>Test API</h1>
                <p class="section-subtitle">Test Database Operations</p>
            </div>

            <!-- Save Data Card -->
            <div class="card upload-card">
                <h2>üíæ Save New Data</h2>
                <p class="card-subtitle">Add new sensor data to database</p>

                <div style="max-width: 600px; margin: 0 auto;">
                    <form id="saveDataForm">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Heart Rate (bpm)</label>
                                <input type="number" id="heartRateInput" min="40" max="200" value="85" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Temperature (¬∞C)</label>
                                <input type="number" id="temperatureInput" step="0.1" min="30" max="45" value="37.0" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Touch Intensity</label>
                                <select id="touchInput" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                    <option value="low">Low</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Movement</label>
                                <select id="movementInput" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                    <option value="normal" selected>Normal</option>
                                    <option value="repetitive">Repetitive</option>
                                    <option value="extreme">Extreme</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Sound</label>
                                <select id="soundInput" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                    <option value="normal" selected>Normal</option>
                                    <option value="frequent">Frequent</option>
                                    <option value="intense">Intense</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">Save Data to Database</button>
                    </form>
                    <div id="saveResult" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                </div>
            </div>

            <!-- Get Data Operations -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- Get Latest Data -->
                <div class="card">
                    <h2>üìä Get Latest Data</h2>
                    <p class="card-subtitle">Fetch most recent records from database</p>
                    <div style="margin: 20px 0;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Number of records</label>
                        <input type="number" id="limitInput" min="1" max="100" value="10" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                    <button onclick="testGetLatestData()" class="btn btn-primary" style="width: 100%;">Get Latest Data</button>
                </div>

                <!-- Get Data by ID -->
                <div class="card">
                    <h2>üîç Get Data by ID</h2>
                    <p class="card-subtitle">Fetch specific record by ID</p>
                    <div style="margin: 20px 0;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Data ID</label>
                        <input type="number" id="dataIdInput" min="1" value="1" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                    <button onclick="testGetDataById()" class="btn btn-primary" style="width: 100%;">Get Data by ID</button>
                </div>
            </div>

            <!-- API Response -->
            <div class="card" id="apiResponseCard" style="display: none;">
                <h2>API Response</h2>
                <pre id="apiResponse" style="background: #f9fafb; padding: 20px; border-radius: 8px; overflow-x: auto; max-height: 400px;"></pre>
            </div>
        </section>

        <!-- ANALYSIS SECTION -->
        <section id="analysis" class="section">
            <div class="section-header">
                <h1>Analysis</h1>
                <p class="section-subtitle">Sensor Data Evaluation from Database</p>
            </div>

            <!-- Trigger Button -->
            <div class="card" style="text-align: center; margin-bottom: 20px;">
                <h2>üìà Analyze Database Data</h2>
                <p class="card-subtitle">Analyze latest 10 records from database and show trend</p>
                <button onclick="analyzeLatestData()" class="btn btn-primary" style="padding: 15px 40px; font-size: 16px;">
                    <i class="fas fa-chart-line"></i> Analyze Latest 10 Data
                </button>
            </div>

            <!-- Empty State (Before Analysis) -->
            <div class="empty-state" id="analysisEmpty">
                <div class="empty-icon">üìä</div>
                <h2>Ready to Analyze</h2>
                <p>Click the button above to analyze the latest data from database.</p>
            </div>

            <!-- Results Container (After Analysis) -->
            <div id="analysisResults" style="display: none;">
                <!-- Chart Container -->
                <div class="card" style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0;">üìà Health Data Trend (Last 10 Data)</h2>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="font-weight: 600; color: #374151;">Display:</label>
                            <select id="analysisChartFilter" onchange="updateAnalysisChart()" style="padding: 8px 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; cursor: pointer;">
                                <option value="riskScore">Risk Score</option>
                                <option value="heartRate">Heart Rate (bpm)</option>
                                <option value="bodyTemperature">Body Temperature (¬∞C)</option>
                                <option value="touchIntensity">Touch Intensity</option>
                                <option value="movementPattern">Movement Pattern</option>
                                <option value="soundActivity">Sound Activity</option>
                            </select>
                        </div>
                    </div>
                    <div style="position: relative; height: 350px;">
                        <canvas id="analysisChart"></canvas>
                    </div>
                </div>

                <!-- Summary Statistics -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="card" style="text-align: center;">
                        <h3 style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">Total Records</h3>
                        <div style="font-size: 36px; font-weight: bold; color: #2563eb;" id="totalRecords">0</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h3 style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">Average Risk</h3>
                        <div style="font-size: 36px; font-weight: bold; color: #f59e0b;" id="avgRisk">0</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h3 style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">üü¢ Low Risk</h3>
                        <div style="font-size: 36px; font-weight: bold; color: #10b981;" id="minRisk">0</div>
                        <small style="color: #6b7280; font-size: 12px;">Score 0-2</small>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h3 style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">üü° Moderate Risk</h3>
                        <div style="font-size: 36px; font-weight: bold; color: #f59e0b;" id="moderateRisk">0</div>
                        <small style="color: #6b7280; font-size: 12px;">Score 3-5</small>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h3 style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">üî¥ High Risk</h3>
                        <div style="font-size: 36px; font-weight: bold; color: #ef4444;" id="maxRisk">0</div>
                        <small style="color: #6b7280; font-size: 12px;">Score 6-10</small>
                    </div>
                </div>

                <!-- Risk Status Card -->
                <div class="card risk-card" id="riskCard">
                    <div class="risk-header">
                        <h2>Latest Data Assessment</h2>
                    </div>
                    <div class="risk-status" id="riskStatus">
                        <div class="risk-icon" id="riskIcon"></div>
                        <div class="risk-label" id="riskLabel"></div>
                    </div>

                    <!-- Risk Progress Bar -->
                    <div class="risk-progress-container">
                        <div class="progress-label">Risk Score Progress</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-info">
                            <span id="scoreValue">0</span>
                            <span class="progress-max">/ 10</span>
                        </div>
                    </div>

                    <div class="risk-explanation" id="riskExplanation"></div>
                </div>

                <!-- Sensor Data Cards Grid -->
                <div class="sensor-grid">
                    <!-- Heart Rate -->
                    <div class="card sensor-card">
                        <div class="sensor-header">
                            <h3>‚ù§Ô∏è Heart Rate</h3>
                        </div>
                        <div class="sensor-value" id="heartRateValue">--</div>
                        <div class="sensor-unit">bpm</div>
                        <div class="sensor-status" id="heartRateStatus"></div>
                    </div>

                    <!-- Body Temperature -->
                    <div class="card sensor-card">
                        <div class="sensor-header">
                            <h3>üå°Ô∏è Body Temperature</h3>
                        </div>
                        <div class="sensor-value" id="temperatureValue">--</div>
                        <div class="sensor-unit">¬∞C</div>
                        <div class="sensor-status" id="temperatureStatus"></div>
                    </div>

                    <!-- Touch Intensity -->
                    <div class="card sensor-card">
                        <div class="sensor-header">
                            <h3>‚úã Touch Intensity</h3>
                        </div>
                        <div class="sensor-value" id="touchValue">--</div>
                        <div class="sensor-unit"></div>
                        <div class="sensor-status" id="touchStatus"></div>
                    </div>

                    <!-- Movement Pattern -->
                    <div class="card sensor-card">
                        <div class="sensor-header">
                            <h3>üö∂ Movement Pattern</h3>
                        </div>
                        <div class="sensor-value" id="movementValue">--</div>
                        <div class="sensor-unit"></div>
                        <div class="sensor-status" id="movementStatus"></div>
                    </div>

                    <!-- Sound Activity -->
                    <div class="card sensor-card">
                        <div class="sensor-header">
                            <h3>üîä Sound Activity</h3>
                        </div>
                        <div class="sensor-value" id="soundValue">--</div>
                        <div class="sensor-unit"></div>
                        <div class="sensor-status" id="soundStatus"></div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="resetAnalysis()">Reset Analysis</button>
                </div>
            </div>
        </section>

        <!-- RECOMMENDATION SECTION -->
        <section id="recommendation" class="section">
            <div class="section-header">
                <h1>Recommendations</h1>
                <p class="section-subtitle">Personalized Guidance from Database Analysis</p>
            </div>

            <!-- Trigger Button -->
            <div class="card" style="text-align: center; margin-bottom: 20px;">
                <h2>üí° Generate Recommendations</h2>
                <p class="card-subtitle">Analyze latest 10 records and generate recommendations</p>
                <button onclick="analyzeRecommendations()" class="btn btn-primary" style="padding: 15px 40px; font-size: 16px;">
                    <i class="fas fa-lightbulb"></i> Analyze & Recommend
                </button>
            </div>

            <!-- Empty State (Before Analysis) -->
            <div class="empty-state" id="recommendationEmpty">
                <div class="empty-icon">üí°</div>
                <h2>Ready to Generate Recommendations</h2>
                <p>Click the button above to analyze data and receive recommendations.</p>
            </div>

            <!-- Recommendations Container (After Analysis) -->
            <div id="recommendationResults" style="display: none;">
                <!-- Chart Container -->
                <div class="card" style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0;">üìä Health Data Trend Analysis</h2>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="font-weight: 600; color: #374151;">Display:</label>
                            <select id="recommendationChartFilter" onchange="updateRecommendationChart()" style="padding: 8px 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; cursor: pointer;">
                                <option value="riskScore">Risk Score</option>
                                <option value="heartRate">Heart Rate (bpm)</option>
                                <option value="bodyTemperature">Body Temperature (¬∞C)</option>
                                <option value="touchIntensity">Touch Intensity</option>
                                <option value="movementPattern">Movement Pattern</option>
                                <option value="soundActivity">Sound Activity</option>
                            </select>
                        </div>
                    </div>
                    <div style="position: relative; height: 350px;">
                        <canvas id="recommendationChart"></canvas>
                    </div>
                </div>

                <!-- Main Recommendation Card -->
                <div class="card recommendation-card" id="recommendationCard">
                    <h2 id="recommendationTitle"></h2>
                    <div id="recommendationContent"></div>
                </div>

                <!-- Additional Resources -->
                <div class="card resources-card">
                    <h2>Next Steps</h2>
                    <ul class="resources-list">
                        <li><strong>Document Results:</strong> Keep a record of this assessment for reference and follow-up.</li>
                        <li><strong>Regular Monitoring:</strong> Conduct regular monitoring sessions to track behavioral patterns over time.</li>
                        <li><strong>Professional Consultation:</strong> If you have concerns, consult with healthcare professionals or child development specialists.</li>
                        <li><strong>Data Sharing:</strong> Share results with relevant educators, therapists, or medical professionals as appropriate.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>¬© 2024 Child Behavior Monitoring System | Educational Prototype | <strong>Not for Medical Diagnosis</strong></p>
        </footer>
    </div>

    <script src="script-dynamic.js"></script>
</body>
</html>
